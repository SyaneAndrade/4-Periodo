import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;

public class FuncionarioDB {

	//Inserir Funcionario no Banco;
	
	public void insereFuncionario(Funcionario objFuncionario) throws ClassNotFoundException, SQLException {
		//INSERT INTO Funcionario VALUES ( '1010',	1,  'Joaquim Neto', 	'Emdereço: Rua Ituiutaba 436B, Bairro: Ns. Aparecida, Uberlandia MG Cep38.400-614', 	'03432081282', 	2000.00);	
		String sql = "Insert into Funcionario values(?,?,?,?,?,?)";
		
		PreparedStatement ps = Conexao.connection().prepareStatement(sql);
		ps.setString(1, objFuncionario.getCodEmi());
		ps.setLong(2, objFuncionario.getCodFunc());
		ps.setString(3, objFuncionario.getNome());
		ps.setString(4,objFuncionario.getEndereco());
		ps.setString(5, objFuncionario.getTelefone());
		ps.setFloat(6, objFuncionario.getSalario());
		
		ps.execute();
		ps.close();
		Conexao.connection().close();
	}

	public void removeFuncionario(Funcionario objFuncionario) throws ClassNotFoundException, SQLException{
	
		String sql = "DELETE FROM Funcionario WHERE CodFunc id = ?;";
		PreparedStatement ps = Conexao.connection().prepareStatement(sql);
		ps.setInt(1,objFuncionario.getCodFunc());
		ps.execute();
		ps.close();
		Conexao.connection().close();
	}
	
	public void alterarFuncionario(Funcionario objFuncionario) throws ClassNotFoundException, SQLException{
		
		String sql = "UPDATE Funcionario SET Endereco = ?, Telefone = ? WHERE codFunc = ?;";
		PreparedStatement ps = Conexao.connection().prepareStatement(sql);
		ps.setString(1, objFuncionario.getEndereco());
		ps.setString(2, objFuncionario.getTelefone());
		ps.execute();
		ps.close();
		Conexao.connection().close();
	}
}

